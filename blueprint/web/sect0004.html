<!DOCTYPE html>
<html lang="en">
<head>
<script>
  MathJax = { 
    tex: {
		    inlineMath: [['$','$'], ['\\(','\\)']]
	} }
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
<meta name="generator" content="plasTeX" />
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Companion Matrices</title>
<link rel="next" href="sect0005.html" title="The Crystallographic Restriction Theorem" />
<link rel="prev" href="sect0003.html" title="Integer Matrix Orders" />
<link rel="up" href="index.html" title="Crystallographic Restriction Theorem" />
<link rel="stylesheet" href="styles/theme-blue.css" />
<link rel="stylesheet" href="styles/showmore.css" />
<link rel="stylesheet" href="styles/blueprint.css" />
<link rel="stylesheet" href="styles/amsthm.css" />
<link rel="stylesheet" href="styles/style.css" />
</head>

<body>
<header>
<svg  id="toc-toggle" class="icon icon-list-numbered "><use xlink:href="symbol-defs.svg#icon-list-numbered"></use></svg>
<h1 id="doc_title"><a href="index.html">Crystallographic Restriction Theorem</a></h1>
</header>

<div class="wrapper">
<nav class="toc">
<ul class="sub-toc-0">
<li class="">
  <a href="sect0001.html"><span class="toc_ref">1</span> <span class="toc_entry">Introduction</span></a>
 </li>
<li class="">
  <a href="sect0002.html"><span class="toc_ref">2</span> <span class="toc_entry">The Psi Function</span></a>
 </li>
<li class="">
  <a href="sect0003.html"><span class="toc_ref">3</span> <span class="toc_entry">Integer Matrix Orders</span></a>
 </li>
<li class=" active current">
  <a href="sect0004.html"><span class="toc_ref">4</span> <span class="toc_entry">Companion Matrices</span></a>
 </li>
<li class="">
  <a href="sect0005.html"><span class="toc_ref">5</span> <span class="toc_entry">The Crystallographic Restriction Theorem</span></a>
 </li>
<li class="">
  <a href="sect0006.html"><span class="toc_ref">A</span> <span class="toc_entry">Appendix</span></a>
 </li>
<li ><a href="dep_graph_document.html">Dependency graph</a></li>
</ul>
</nav>

<div class="content">
<div class="content-wrapper">


<div class="main-text">
<h1 id="a0000000005">4 Companion Matrices</h1>
<p>Companion matrices provide a key construction for achieving orders via cyclotomic polynomials. </p>
<div class="definition_thmwrapper theorem-style-definition" id="companion-def">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">4.0.1</span>
    <div class="thm_header_extras">

    
    ✓
        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0004.html#companion-def">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.companion" class="lean_decl">Crystallographic.companion</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>   The companion matrix \(C(p)\) of a monic polynomial \(p = X^n + a_{n-1}X^{n-1} + \cdots + a_0\) is the \(n \times n\) matrix with \(1\)s on the subdiagonal and \(-a_i\) in the last column: </p>
<div class="displaymath" id="a0000000036">
  \[ C(p) = \begin{pmatrix}  0 

&  0 

&  \cdots 

&  -a_0 

\\ 1 

&  0 

&  \cdots 

&  -a_1 

\\ \vdots 

&  \ddots 

& &  \vdots 

\\ 0 

&  \cdots 

&  1 

&  -a_{n-1} 

\end{pmatrix} \]
</div>
<p> This construction produces a matrix whose characteristic polynomial equals \(p\), providing a canonical matrix realization for any monic polynomial. </p>

  </div>
  <div class="thm_body_extras">


<div class="lean-source-panel">
    <div class="lean-source-header">
        <span class="lean-source-title">Lean Source</span>
        
        <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/Companion/Basic.lean#L46-L74" class="lean-github-link" target="_blank" rel="noopener">View on GitHub</a>
        
    </div>
    <pre class="lean-code"><code><span class="lean-plain">/-- The companion matrix of a monic polynomial p of degree n.

For p = X^n + a_{n-1}X^{n-1} + ... + a_1 X + a_0, the companion matrix is:
```
[0  0  0  ...  0  -a_0    ]
[1  0  0  ...  0  -a_1    ]
[0  1  0  ...  0  -a_2    ]
[        ...              ]
[0  0  0  ...  1  -a_{n-1}]
```

The matrix has 1s on the subdiagonal and the negatives of the polynomial
coefficients in the last column.
-/
@[blueprint
  &quot;companion-def&quot;
  (statement := /-- The companion matrix $C(p)$ of a monic polynomial
  $p = X^n + a_{n-1}X^{n-1} + \cdots + a_0$ is the $n \times n$ matrix with $1$s
  on the subdiagonal and $-a_i$ in the last column:
  $$C(p) = \begin{pmatrix} 0 &amp; 0 &amp; \cdots &amp; -a_0 \\ 1 &amp; 0 &amp; \cdots &amp; -a_1 \\
  \vdots &amp; \ddots &amp; &amp; \vdots \\ 0 &amp; \cdots &amp; 1 &amp; -a_{n-1} \end{pmatrix}$$
  This construction produces a matrix whose characteristic polynomial equals $p$, providing
  a canonical matrix realization for any monic polynomial. -/)]
def companion (p : R[X]) (_hp : p.Monic) (_hn : 0 &lt; p.natDegree) :
    Matrix (Fin p.natDegree) (Fin p.natDegree) R :=
  Matrix.of fun i j =&gt;
    if j.val + 1 = i.val then 1
    else if j.val + 1 = p.natDegree then -p.coeff i.val
    else 0
</span></code></pre>
</div>
  </div>
</div>
<div class="theorem_thmwrapper theorem-style-definition" id="thm:companion-charpoly">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">4.0.1</span>
    <div class="thm_header_extras">

    
    ✓
        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0004.html#thm:companion-charpoly">#</a>
    
    <a class="icon proof" href="sect0004.html#a0000000037"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0004.html#companion-def">Definition 4.0.1</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.companion_charpoly" class="lean_decl">Crystallographic.companion_charpoly</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>    The characteristic polynomial of the companion matrix \(C(p)\) equals \(p\): \(\chi _{C(p)} = p\). The proof proceeds by induction on the degree, using cofactor expansion along the first column. The key insight is that the minor structure reduces to smaller companion matrices, and the base case (degree 1) follows by direct computation.  </p>

  </div>
  <div class="thm_body_extras">


<div class="lean-source-panel">
    <div class="lean-source-header">
        <span class="lean-source-title">Lean Source</span>
        
        <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/Companion/Basic.lean#L501-L542" class="lean-github-link" target="_blank" rel="noopener">View on GitHub</a>
        
    </div>
    <pre class="lean-code"><code><span class="lean-plain">/-- The characteristic polynomial of the companion matrix equals the original polynomial.

This is the fundamental property of companion matrices: they are constructed precisely
so that their characteristic polynomial matches the given monic polynomial.

The proof proceeds by strong induction on the degree n. For degree 1, direct computation
shows both sides equal X + C(a_0). For degree n+1, Laplace expansion along the first
column gives a recurrence matching the polynomial structure.
-/
@[blueprint
  &quot;thm:companion-charpoly&quot;
  (statement := /-- The characteristic polynomial of the companion matrix $C(p)$ equals $p$:
  $\chi_{C(p)} = p$. The proof proceeds by induction on the degree, using cofactor expansion
  along the first column. The key insight is that the minor structure reduces to smaller
  companion matrices, and the base case (degree 1) follows by direct computation.
  \uses{companion-def} -/)
  (proof := /-- By induction on the degree $n$. For the base case $n = 1$, direct computation gives
  $\det(XI - C) = X + a_0$. For $n &gt; 1$, expand along the first column: the $(1,1)$ minor
  is the companion matrix of lower degree, and the $(2,1)$ minor contributes the constant
  term. The recurrence matches the polynomial coefficients. -/)]
theorem companion_charpoly (p : R[X]) (hp : p.Monic) (hn : 0 &lt; p.natDegree) :
    (companion p hp hn).charpoly = p := by
  obtain ⟨n, hn_eq⟩ : ∃ n, p.natDegree = n + 1 := Nat.exists_eq_succ_of_ne_zero hn.ne&#x27;
  induction n generalizing p with
  | zero =&gt; exact companion_charpoly_of_natDegree_one p hp hn hn_eq
  | succ m IH =&gt;
    have hdeg : p.natDegree = m + 2 := hn_eq
    let A : Matrix (Fin (m + 2)) (Fin (m + 2)) R[X] :=
      (companion p hp hn).charmatrix.submatrix (Fin.cast hdeg.symm) (Fin.cast hdeg.symm)
    have hA_def : A = (companion p hp hn).charmatrix.submatrix
        (Fin.cast hdeg.symm) (Fin.cast hdeg.symm) := rfl
    have hA_det : A.det = (companion p hp hn).charmatrix.det := by
      have heq : A = (companion p hp hn).charmatrix.submatrix
          (finCongr hdeg.symm) (finCongr hdeg.symm) := by
        ext i j; simp only [Matrix.submatrix_apply]; rfl
      rw [heq, Matrix.det_submatrix_equiv_self]
    rw [Matrix.charpoly, ← hA_det, Matrix.det_succ_column_zero]
    -- Get column structure and apply Laplace simplification
    obtain ⟨hA00, hA10, hA_other⟩ := companion_charmatrix_col_zero p hp hn m hdeg A hA_def
    rw [companion_charmatrix_laplace_col_zero m A hA00 hA10 hA_other, ← Polynomial.X_mul_divX_add p,
      companion_charmatrix_minor00_det p hp hn m hdeg A hA_def IH,
      companion_charmatrix_minor10_det p hp hn m hdeg A hA_def]
</span></code></pre>
</div>
  </div>
</div>
<div class="proof_wrapper" id="a0000000037">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▶</span>
  </div>
  <div class="proof_content">
  <p>By induction on the degree \(n\). For the base case \(n = 1\), direct computation gives \(\det (XI - C) = X + a_0\). For \(n {\gt} 1\), expand along the first column: the \((1,1)\) minor is the companion matrix of lower degree, and the \((2,1)\) minor contributes the constant term. The recurrence matches the polynomial coefficients. </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-definition" id="lem:companion-aeval-zero">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">4.0.2</span>
    <div class="thm_header_extras">

    
    ✓
        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0004.html#lem:companion-aeval-zero">#</a>
    
    <a class="icon proof" href="sect0004.html#a0000000038"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0004.html#thm:companion-charpoly">Theorem 4.0.1</a></li>
          
          <li><a href="sect0004.html#thm:companion-charpoly">Theorem 4.0.1</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.companion_aeval_eq_zero" class="lean_decl">Crystallographic.companion_aeval_eq_zero</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>    \(p(C(p)) = 0\) (Cayley-Hamilton). By the Cayley-Hamilton theorem, every matrix satisfies its characteristic polynomial. Since the characteristic polynomial of \(C(p)\) is exactly \(p\) (by <span class="ttfamily">companion_charpoly</span>), we have \(p(C(p)) = 0\).  </p>

  </div>
  <div class="thm_body_extras">


<div class="lean-source-panel">
    <div class="lean-source-header">
        <span class="lean-source-title">Lean Source</span>
        
        <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/Companion/Basic.lean#L546-L557" class="lean-github-link" target="_blank" rel="noopener">View on GitHub</a>
        
    </div>
    <pre class="lean-code"><code><span class="lean-plain">@[simp, blueprint &quot;lem:companion-aeval-zero&quot;
  (statement := /-- $p(C(p)) = 0$ (Cayley-Hamilton). By the Cayley-Hamilton theorem, every
  matrix satisfies its characteristic polynomial. Since the characteristic polynomial of
  $C(p)$ is exactly $p$ (by \texttt{companion\_charpoly}), we have $p(C(p)) = 0$.
  \uses{thm:companion-charpoly} -/)
  (proof := /-- By Cayley-Hamilton, every matrix satisfies its characteristic polynomial.
  Since $\chi_{C(p)} = p$ by the companion characteristic polynomial theorem,
  we have $p(C(p)) = 0$. -/)]
theorem companion_aeval_eq_zero (p : R[X]) (hp : p.Monic) (hn : 0 &lt; p.natDegree) :
    aeval (companion p hp hn) p = 0 := by
  have h := aeval_self_charpoly (companion p hp hn)
  rwa [companion_charpoly p hp hn] at h
</span></code></pre>
</div>
  </div>
</div>
<div class="proof_wrapper" id="a0000000038">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▶</span>
  </div>
  <div class="proof_content">
  <p> By Cayley-Hamilton, every matrix satisfies its characteristic polynomial. Since \(\chi _{C(p)} = p\) by the companion characteristic polynomial theorem, we have \(p(C(p)) = 0\). </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-definition" id="thm:companion-pow-dvd">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">4.0.3</span>
    <div class="thm_header_extras">

    
    ✓
        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0004.html#thm:companion-pow-dvd">#</a>
    
    <a class="icon proof" href="sect0004.html#a0000000039"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0004.html#lem:companion-aeval-zero">Theorem 4.0.2</a></li>
          
          <li><a href="sect0004.html#lem:companion-aeval-zero">Theorem 4.0.2</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.companion_pow_eq_one_of_dvd" class="lean_decl">Crystallographic.companion_pow_eq_one_of_dvd</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>    If \(p \mid X^m - 1\), then \(C(p)^m = I\). If \(p \mid X^m - 1\), write \(X^m - 1 = p \cdot q\) for some \(q\). Since \(p(C(p)) = 0\), evaluating at \(C(p)\) gives \((X^m - 1)(C(p)) = p(C(p)) \cdot q(C(p)) = 0\), so \(C(p)^m - I = 0\).  </p>

  </div>
  <div class="thm_body_extras">


<div class="lean-source-panel">
    <div class="lean-source-header">
        <span class="lean-source-title">Lean Source</span>
        
        <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/Companion/Basic.lean#L561-L586" class="lean-github-link" target="_blank" rel="noopener">View on GitHub</a>
        
    </div>
    <pre class="lean-code"><code><span class="lean-plain">@[blueprint &quot;thm:companion-pow-dvd&quot;
  (statement := /-- If $p \mid X^m - 1$, then $C(p)^m = I$. If $p \mid X^m - 1$, write
  $X^m - 1 = p \cdot q$ for some $q$. Since $p(C(p)) = 0$, evaluating at $C(p)$ gives
  $(X^m - 1)(C(p)) = p(C(p)) \cdot q(C(p)) = 0$, so $C(p)^m - I = 0$.
  \uses{lem:companion-aeval-zero} -/)
  (proof := /-- If $p \mid X^m - 1$, write $X^m - 1 = p \cdot q$ for some polynomial $q$.
  Evaluating at $C(p)$: $(X^m - 1)(C(p)) = p(C(p)) \cdot q(C(p)) = 0 \cdot q(C(p)) = 0$,
  so $C(p)^m = I$. -/)]
theorem companion_pow_eq_one_of_dvd (p : R[X]) (hp : p.Monic) (hn : 0 &lt; p.natDegree)
    (m : ℕ) (hdvd : p ∣ X ^ m - 1) :
    (companion p hp hn) ^ m = 1 := by
  -- From hdvd, get q such that X^m - 1 = p * q
  obtain ⟨q, hq⟩ := hdvd
  -- Let A = companion p
  let A := companion p hp hn
  -- We have aeval A p = 0 by companion_aeval_eq_zero
  have hp_zero : aeval A p = 0 := companion_aeval_eq_zero p hp hn
  -- Therefore aeval A (X^m - 1) = aeval A (p * q) = aeval A p * aeval A q = 0
  have hXm1_zero : aeval A (X ^ m - (1 : R[X])) = 0 := by
    rw [hq, aeval_mul, hp_zero, zero_mul]
  -- But aeval A (X^m - 1) = A^m - 1
  have haeval : aeval A (X ^ m - (1 : R[X])) = A ^ m - 1 := by
    simp only [map_sub, map_pow, aeval_X, map_one]
  -- So A^m - 1 = 0, i.e., A^m = 1
  rw [haeval] at hXm1_zero
  exact sub_eq_zero.mp hXm1_zero
</span></code></pre>
</div>
  </div>
</div>
<div class="proof_wrapper" id="a0000000039">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▶</span>
  </div>
  <div class="proof_content">
  <p> If \(p \mid X^m - 1\), write \(X^m - 1 = p \cdot q\) for some polynomial \(q\). Evaluating at \(C(p)\): \((X^m - 1)(C(p)) = p(C(p)) \cdot q(C(p)) = 0 \cdot q(C(p)) = 0\), so \(C(p)^m = I\). </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-definition" id="lem:companion-cycl-pow">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">4.0.4</span>
    <div class="thm_header_extras">

    
    ✓
        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0004.html#lem:companion-cycl-pow">#</a>
    
    <a class="icon proof" href="sect0004.html#a0000000040"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0004.html#thm:companion-pow-dvd">Theorem 4.0.3</a></li>
          
          <li><a href="sect0004.html#thm:companion-pow-dvd">Theorem 4.0.3</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.companion_cyclotomic_pow_eq_one" class="lean_decl">Crystallographic.companion_cyclotomic_pow_eq_one</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>    \(C(\Phi _m)^m = I\). Since the cyclotomic polynomial \(\Phi _m\) divides \(X^m - 1\) (as \(X^m - 1 = \prod _{d \mid m} \Phi _d\)), we apply <span class="ttfamily">companion_pow_eq_one_of_dvd</span>.  </p>

  </div>
  <div class="thm_body_extras">


<div class="lean-source-panel">
    <div class="lean-source-header">
        <span class="lean-source-title">Lean Source</span>
        
        <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/Companion/Cyclotomic.lean#L39-L50" class="lean-github-link" target="_blank" rel="noopener">View on GitHub</a>
        
    </div>
    <pre class="lean-code"><code><span class="lean-plain">@[blueprint &quot;lem:companion-cycl-pow&quot;
  (statement := /-- $C(\Phi_m)^m = I$. Since the cyclotomic polynomial $\Phi_m$ divides
  $X^m - 1$ (as $X^m - 1 = \prod_{d \mid m} \Phi_d$), we apply
  \texttt{companion\_pow\_eq\_one\_of\_dvd}.
  \uses{thm:companion-pow-dvd} -/)
  (proof := /-- Since $\Phi_m \mid X^m - 1$ (as $X^m - 1 = \prod_{d \mid m} \Phi_d$), we apply
  the general companion power theorem to conclude $C(\Phi_m)^m = I$. -/)]
lemma companion_cyclotomic_pow_eq_one (m : ℕ)
    (hn : 0 &lt; (cyclotomic m ℤ).natDegree) :
    (companion (cyclotomic m ℤ) (cyclotomic.monic m ℤ) hn) ^ m = 1 := by
  apply companion_pow_eq_one_of_dvd
  exact cyclotomic.dvd_X_pow_sub_one m ℤ
</span></code></pre>
</div>
  </div>
</div>
<div class="proof_wrapper" id="a0000000040">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▶</span>
  </div>
  <div class="proof_content">
  <p> Since \(\Phi _m \mid X^m - 1\) (as \(X^m - 1 = \prod _{d \mid m} \Phi _d\)), we apply the general companion power theorem to conclude \(C(\Phi _m)^m = I\). </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-definition" id="thm:companion-cycl-order">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">4.0.5</span>
    <div class="thm_header_extras">

    
    ✓
        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0004.html#thm:companion-cycl-order">#</a>
    
    <a class="icon proof" href="sect0004.html#a0000000041"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0004.html#lem:companion-cycl-pow">Theorem 4.0.4</a></li>
          
          <li><a href="sect0004.html#lem:companion-aeval-zero">Theorem 4.0.2</a></li>
          
          <li><a href="sect0004.html#thm:companion-charpoly">Theorem 4.0.1</a></li>
          
          <li><a href="sect0004.html#lem:companion-cycl-pow">Theorem 4.0.4</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.companion_cyclotomic_orderOf" class="lean_decl">Crystallographic.companion_cyclotomic_orderOf</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>    \(\mathrm{ord}(C(\Phi _m)) = m\) for \(m \geq 2\). The order is exactly \(m\) because: (1) \(\Phi _m \mid X^m - 1\) implies \(C(\Phi _m)^m = I\), and (2) if \(C(\Phi _m)^d = I\) for \(d {\lt} m\), then \(\Phi _m\) would divide \(X^d - 1\), contradicting that primitive \(m\)-th roots of unity are not \(d\)-th roots of unity for \(d {\lt} m\).  </p>

  </div>
  <div class="thm_body_extras">


<div class="lean-source-panel">
    <div class="lean-source-header">
        <span class="lean-source-title">Lean Source</span>
        
        <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/Companion/Cyclotomic.lean#L110-L141" class="lean-github-link" target="_blank" rel="noopener">View on GitHub</a>
        
    </div>
    <pre class="lean-code"><code><span class="lean-plain">@[blueprint &quot;thm:companion-cycl-order&quot;
  (statement := /-- $\mathrm{ord}(C(\Phi_m)) = m$ for $m \geq 2$. The order is exactly $m$
  because: (1) $\Phi_m \mid X^m - 1$ implies $C(\Phi_m)^m = I$, and (2) if $C(\Phi_m)^d = I$
  for $d &lt; m$, then $\Phi_m$ would divide $X^d - 1$, contradicting that primitive $m$-th
  roots of unity are not $d$-th roots of unity for $d &lt; m$.
  \uses{lem:companion-cycl-pow, lem:companion-aeval-zero} -/)
  (proof := /-- The order is at most $m$ since $\Phi_m \mid X^m - 1$ implies $C(\Phi_m)^m = I$.
  For the lower bound: if $C(\Phi_m)^d = I$ for $d &lt; m$, then $\Phi_m \mid X^d - 1$,
  but this contradicts that primitive $m$-th roots of unity are not $d$-th roots. -/)]
theorem companion_cyclotomic_orderOf (m : ℕ) (hm : 2 ≤ m)
    (hn : 0 &lt; (cyclotomic m ℤ).natDegree) :
    orderOf (companion (cyclotomic m ℤ) (cyclotomic.monic m ℤ) hn) = m := by
  let A := companion (cyclotomic m ℤ) (cyclotomic.monic m ℤ) hn
  have hm_pos : 0 &lt; m := Nat.lt_of_lt_of_le (by norm_num : 0 &lt; 2) hm
  rw [orderOf_eq_iff hm_pos]
  constructor
  · exact companion_cyclotomic_pow_eq_one m hn
  · intro k hk hk_pos hAk
    have haeval_zero : aeval A (X ^ k - (1 : ℤ[X])) = 0 := by
      simp only [map_sub, map_pow, aeval_X, map_one]
      rw [hAk, sub_self]
    -- Work over ℚ where cyclotomic is irreducible
    let AQ := A.map (algebraMap ℤ ℚ)
    have haeval_Q_zero : aeval AQ ((X ^ k - 1 : ℤ[X]).map (algebraMap ℤ ℚ)) = 0 := by
      have : AQ = (Algebra.ofId ℤ ℚ).mapMatrix A := rfl
      rw [this, aeval_map_algebraMap, aeval_algHom_apply, haeval_zero, map_zero]
    simp only [Polynomial.map_sub, Polynomial.map_pow, Polynomial.map_X, Polynomial.map_one]
      at haeval_Q_zero
    have hdvd1 : minpoly ℚ AQ ∣ (X ^ k - 1 : ℚ[X]) := minpoly.dvd ℚ AQ haeval_Q_zero
    have hminpoly_eq : minpoly ℚ AQ = cyclotomic m ℚ := companion_cyclotomic_minpoly m hm_pos hn
    rw [hminpoly_eq] at hdvd1
    exact Nat.not_dvd_of_pos_of_lt hk_pos hk (dvd_of_cyclotomic_dvd_X_pow_sub_one m k hm_pos hk_pos hdvd1)
</span></code></pre>
</div>
  </div>
</div>
<div class="proof_wrapper" id="a0000000041">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▶</span>
  </div>
  <div class="proof_content">
  <p> The order is at most \(m\) since \(\Phi _m \mid X^m - 1\) implies \(C(\Phi _m)^m = I\). For the lower bound: if \(C(\Phi _m)^d = I\) for \(d {\lt} m\), then \(\Phi _m \mid X^d - 1\), but this contradicts that primitive \(m\)-th roots of unity are not \(d\)-th roots. </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-definition" id="thm:companion-cycl-mem">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">4.0.6</span>
    <div class="thm_header_extras">

    
    ✓
        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0004.html#thm:companion-cycl-mem">#</a>
    
    <a class="icon proof" href="sect0004.html#a0000000042"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0004.html#thm:companion-cycl-order">Theorem 4.0.5</a></li>
          
          <li><a href="sect0004.html#companion-def">Definition 4.0.1</a></li>
          
          <li><a href="sect0004.html#thm:companion-cycl-order">Theorem 4.0.5</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.companion_cyclotomic_mem_integerMatrixOrders" class="lean_decl">Crystallographic.companion_cyclotomic_mem_integerMatrixOrders</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>    \(m \in \mathrm{Ord}_{\varphi (m)}\) via \(C(\Phi _m)\). Since \(\deg (\Phi _m) = \varphi (m)\), the companion matrix \(C(\Phi _m)\) is \(\varphi (m) \times \varphi (m)\) with integer entries, and has order exactly \(m\) by <span class="ttfamily">companion_cyclotomic_orderOf</span>.  </p>

  </div>
  <div class="thm_body_extras">


<div class="lean-source-panel">
    <div class="lean-source-header">
        <span class="lean-source-title">Lean Source</span>
        
        <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/Companion/Cyclotomic.lean#L145-L158" class="lean-github-link" target="_blank" rel="noopener">View on GitHub</a>
        
    </div>
    <pre class="lean-code"><code><span class="lean-plain">@[blueprint &quot;thm:companion-cycl-mem&quot;
  (statement := /-- $m \in \mathrm{Ord}_{\varphi(m)}$ via $C(\Phi_m)$. Since
  $\deg(\Phi_m) = \varphi(m)$, the companion matrix $C(\Phi_m)$ is $\varphi(m) \times \varphi(m)$
  with integer entries, and has order exactly $m$ by \texttt{companion\_cyclotomic\_orderOf}.
  \uses{thm:companion-cycl-order} -/)
  (proof := /-- The companion matrix $C(\Phi_m)$ witnesses the membership: it is an integer matrix
  of dimension $\deg(\Phi_m) = \varphi(m)$ with multiplicative order exactly $m$. -/)]
theorem companion_cyclotomic_mem_integerMatrixOrders (m : ℕ) (hm : 2 ≤ m)
    (hn : 0 &lt; (cyclotomic m ℤ).natDegree) :
    m ∈ Crystallographic.integerMatrixOrders (cyclotomic m ℤ).natDegree := by
  use companion (cyclotomic m ℤ) (cyclotomic.monic m ℤ) hn
  constructor
  · exact companion_cyclotomic_orderOf m hm hn
  · omega
</span></code></pre>
</div>
  </div>
</div>
<div class="proof_wrapper" id="a0000000042">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▶</span>
  </div>
  <div class="proof_content">
  <p> The companion matrix \(C(\Phi _m)\) witnesses the membership: it is an integer matrix of dimension \(\deg (\Phi _m) = \varphi (m)\) with multiplicative order exactly \(m\). </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-definition" id="thm:mem-orders-totient">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">4.0.7</span>
    <div class="thm_header_extras">

    
    ✓
        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0004.html#thm:mem-orders-totient">#</a>
    
    <a class="icon proof" href="sect0004.html#a0000000043"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0004.html#thm:companion-cycl-mem">Theorem 4.0.6</a></li>
          
          <li><a href="sect0004.html#thm:companion-cycl-mem">Theorem 4.0.6</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.mem_integerMatrixOrders_totient" class="lean_decl">Crystallographic.mem_integerMatrixOrders_totient</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>    For \(m \geq 2\), \(m \in \mathrm{Ord}_{\varphi (m)}\). This is the key existence result: for every \(m \geq 2\), there exists an integer matrix of dimension \(\varphi (m)\) with multiplicative order exactly \(m\), namely the companion matrix of \(\Phi _m\).  </p>

  </div>
  <div class="thm_body_extras">


<div class="lean-source-panel">
    <div class="lean-source-header">
        <span class="lean-source-title">Lean Source</span>
        
        <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/Companion/Cyclotomic.lean#L160-L173" class="lean-github-link" target="_blank" rel="noopener">View on GitHub</a>
        
    </div>
    <pre class="lean-code"><code><span class="lean-plain">@[blueprint &quot;thm:mem-orders-totient&quot;
  (statement := /-- For $m \geq 2$, $m \in \mathrm{Ord}_{\varphi(m)}$. This is the key
  existence result: for every $m \geq 2$, there exists an integer matrix of dimension
  $\varphi(m)$ with multiplicative order exactly $m$, namely the companion matrix of $\Phi_m$.
  \uses{thm:companion-cycl-mem} -/)
  (proof := /-- Apply the cyclotomic companion membership theorem after noting that
  $\deg(\Phi_m) = \varphi(m)$. -/)]
theorem mem_integerMatrixOrders_totient (m : ℕ) (hm : 2 ≤ m) :
    m ∈ Crystallographic.integerMatrixOrders (Nat.totient m) := by
  have hdeg : (cyclotomic m ℤ).natDegree = Nat.totient m := Polynomial.natDegree_cyclotomic m ℤ
  have htot_pos : 0 &lt; Nat.totient m := Nat.totient_pos.mpr (by omega)
  have hn : 0 &lt; (cyclotomic m ℤ).natDegree := by omega
  rw [← hdeg]
  exact companion_cyclotomic_mem_integerMatrixOrders m hm hn
</span></code></pre>
</div>
  </div>
</div>
<div class="proof_wrapper" id="a0000000043">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▶</span>
  </div>
  <div class="proof_content">
  <p> Apply the cyclotomic companion membership theorem after noting that \(\deg (\Phi _m) = \varphi (m)\). </p>

  </div>
</div>

</div> <!--main-text -->
</div> <!-- content-wrapper -->
</div> <!-- content -->
</div> <!-- wrapper -->

<nav class="prev_up_next">
  <svg  id="showmore-minus" class="icon icon-eye-minus showmore"><use xlink:href="symbol-defs.svg#icon-eye-minus"></use></svg>

  <svg  id="showmore-plus" class="icon icon-eye-plus showmore"><use xlink:href="symbol-defs.svg#icon-eye-plus"></use></svg>

  <a href="sect0003.html" title="Integer Matrix Orders"><svg  class="icon icon-arrow-left "><use xlink:href="symbol-defs.svg#icon-arrow-left"></use></svg>
</a>
  <a href="index.html" title="Crystallographic Restriction Theorem"><svg  class="icon icon-arrow-up "><use xlink:href="symbol-defs.svg#icon-arrow-up"></use></svg>
</a>
  <a href="sect0005.html" title="The Crystallographic Restriction Theorem"><svg  class="icon icon-arrow-right "><use xlink:href="symbol-defs.svg#icon-arrow-right"></use></svg>
</a>
</nav>

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/plastex.js"></script>
<script type="text/javascript" src="js/svgxuse.js"></script>
<script type="text/javascript" src="js/js.cookie.min.js"></script>
<script type="text/javascript" src="js/showmore.js"></script>
</body>
</html>