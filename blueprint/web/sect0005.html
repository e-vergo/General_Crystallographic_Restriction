<!DOCTYPE html>
<html lang="en">
<head>
<script>
  MathJax = { 
    tex: {
		    inlineMath: [['$','$'], ['\\(','\\)']]
	} }
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
<meta name="generator" content="plasTeX" />
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>The Crystallographic Restriction Theorem</title>
<link rel="next" href="sect0006.html" title="Appendix" />
<link rel="prev" href="sect0004.html" title="Companion Matrices" />
<link rel="up" href="index.html" title="Crystallographic Restriction Theorem" />
<link rel="stylesheet" href="styles/theme-blue.css" />
<link rel="stylesheet" href="styles/showmore.css" />
<link rel="stylesheet" href="styles/blueprint.css" />
<link rel="stylesheet" href="styles/amsthm.css" />
<link rel="stylesheet" href="styles/style.css" />
</head>

<body>
<header>
<svg  id="toc-toggle" class="icon icon-list-numbered "><use xlink:href="symbol-defs.svg#icon-list-numbered"></use></svg>
<h1 id="doc_title"><a href="index.html">Crystallographic Restriction Theorem</a></h1>
</header>

<div class="wrapper">
<nav class="toc">
<ul class="sub-toc-0">
<li class="">
  <a href="sect0001.html"><span class="toc_ref">1</span> <span class="toc_entry">Introduction</span></a>
 </li>
<li class="">
  <a href="sect0002.html"><span class="toc_ref">2</span> <span class="toc_entry">The Psi Function</span></a>
 </li>
<li class="">
  <a href="sect0003.html"><span class="toc_ref">3</span> <span class="toc_entry">Integer Matrix Orders</span></a>
 </li>
<li class="">
  <a href="sect0004.html"><span class="toc_ref">4</span> <span class="toc_entry">Companion Matrices</span></a>
 </li>
<li class=" active current">
  <a href="sect0005.html"><span class="toc_ref">5</span> <span class="toc_entry">The Crystallographic Restriction Theorem</span></a>
 </li>
<li class="">
  <a href="sect0006.html"><span class="toc_ref">A</span> <span class="toc_entry">Appendix</span></a>
 </li>
<li ><a href="dep_graph_document.html">Dependency graph</a></li>
</ul>
</nav>

<div class="content">
<div class="content-wrapper">


<div class="main-text">
<h1 id="a0000000006">5 The Crystallographic Restriction Theorem</h1>
<p>The proof splits into two directions: showing \(\psi (m) \leq N\) is necessary (forward) and sufficient (backward) for \(m \in \mathrm{Ord}_N\). </p>
<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="lem:pow-eq-one-of-minpoly-dvd">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.1</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#lem:pow-eq-one-of-minpoly-dvd">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000044"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Matrix.pow_eq_one_of_minpoly_dvd_X_pow_sub_one" class="lean_decl">Matrix.pow_eq_one_of_minpoly_dvd_X_pow_sub_one</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>     If \(\mu _A \mid X^k - 1\), then \(A^k = I\).  </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000044">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p>The polynomial \(X^k - 1\) annihilates \(A\) (since the minimal polynomial does), meaning \(A^k - I = 0\). Transfer this identity from \(\mathbb {Q}\) back to \(\mathbb {Z}\) via the injectivity of \(\mathbb {Z} \to \mathbb {Q}\). </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">lemma pow_eq_one_of_minpoly_dvd_X_pow_sub_one {N : ℕ} (A : Matrix (Fin N) (Fin N) ℤ) (k : ℕ)</span></code><code class="lean-proof-body"><span class="lean-plain">{N : ℕ} (A : Matrix (Fin N) (Fin N) ℤ) (k : ℕ)
    (hdvd : minpoly ℚ (A.map (algebraMap ℤ ℚ)) ∣ X ^ k - 1) : A ^ k = 1 := by
  let A_Q := A.map (algebraMap ℤ ℚ)
  -- If minpoly | X^k - 1, then aeval A_Q (X^k - 1) = 0
  have haeval : aeval A_Q (X ^ k - 1 : ℚ[X]) = 0 := by
    obtain ⟨q, hq⟩ := hdvd
    rw [hq, map_mul, minpoly.aeval, zero_mul]
  -- This means A_Q^k = 1
  simp only [map_sub, map_pow, aeval_X, map_one, sub_eq_zero] at haeval
  -- Transfer back to A via injectivity
  have hinj := Crystallographic.Matrix.map_algebraMap_int_injective N
  apply hinj
  change (A ^ k).map (algebraMap ℤ ℚ) =
    (1 : Matrix (Fin N) (Fin N) ℤ).map (algebraMap ℤ ℚ)
  rw [Matrix.map_pow, Matrix.map_one (algebraMap ℤ ℚ) (map_zero _) (map_one _)]
  exact haeval</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Forward.lean#L56-L56" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="lem:minpoly-dvd-X-pow-sub-one">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.2</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#lem:minpoly-dvd-X-pow-sub-one">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000045"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Matrix.minpoly_dvd_X_pow_sub_one_of_pow_eq_one" class="lean_decl">Matrix.minpoly_dvd_X_pow_sub_one_of_pow_eq_one</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>     If \(A^m = I\), then \(\mu _A \mid X^m - 1\).  </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000045">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p>The polynomial \(X^m - 1\) annihilates \(A\) since \((A_{\mathbb {Q}})^m - I = 0\). The minimal polynomial divides any annihilating polynomial by definition. </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">lemma minpoly_dvd_X_pow_sub_one_of_pow_eq_one {N : ℕ} (A : Matrix (Fin N) (Fin N) ℤ) (m : ℕ)</span></code><code class="lean-proof-body"><span class="lean-plain">{N : ℕ} (A : Matrix (Fin N) (Fin N) ℤ) (m : ℕ)
    (hpow : A ^ m = 1) : minpoly ℚ (A.map (algebraMap ℤ ℚ)) ∣ X ^ m - 1 := by
  apply minpoly.dvd
  simp only [map_sub, map_pow, aeval_X, map_one]
  rw [← Matrix.map_pow, hpow,
    Matrix.map_one (algebraMap ℤ ℚ) (map_zero _) (map_one _), sub_self]</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Forward.lean#L80-L80" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="lem:cyclotomic-finset-product-dvd">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.3</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#lem:cyclotomic-finset-product-dvd">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000046"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.cyclotomic_finset_product_dvd" class="lean_decl">Crystallographic.cyclotomic_finset_product_dvd</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>     If \(\Phi _d \mid f\) for all \(d \in S\), then \(\prod _{d \in S} \Phi _d \mid f\). </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000046">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p>By induction on \(S\). The empty product divides everything. For the insert case, use that cyclotomic polynomials with distinct indices are coprime over \(\mathbb {Q}\), so \(\Phi _d\) is coprime to \(\prod _{x \in s} \Phi _x\) when \(d \notin s\). Then apply coprime divisibility: if \(a, b\) are coprime and both divide \(f\), then \(ab \mid f\). </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">lemma cyclotomic_finset_product_dvd {target : ℚ[X]} (S : Finset ℕ)</span></code><code class="lean-proof-body"><span class="lean-plain">{target : ℚ[X]} (S : Finset ℕ)
    (hdvd_each : ∀ d ∈ S, cyclotomic d ℚ ∣ target) :
    (∏ d ∈ S, cyclotomic d ℚ) ∣ target := by
  induction S using Finset.induction with
  | empty =&gt; simp only [Finset.prod_empty, one_dvd]
  | @insert d s hd_notin IH =&gt;
    rw [Finset.prod_insert hd_notin]
    have hdvd_d : cyclotomic d ℚ ∣ target := hdvd_each d (Finset.mem_insert_self d s)
    have hdvd_prod : (∏ x ∈ s, cyclotomic x ℚ) ∣ target :=
        IH (fun x hx =&gt; hdvd_each x (Finset.mem_insert_of_mem hx))
    have hcop : IsCoprime (cyclotomic d ℚ) (∏ x ∈ s, cyclotomic x ℚ) := by
      apply IsCoprime.prod_right
      intro x hx
      exact cyclotomic.isCoprime_rat (fun heq =&gt; hd_notin (heq ▸ hx))
    exact hcop.mul_dvd hdvd_d hdvd_prod</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Forward.lean#L101-L101" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="lem:minpoly-dvd-prod-cyclotomic">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.4</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#lem:minpoly-dvd-prod-cyclotomic">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000047"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0005.html#lem:cyclotomic-finset-product-dvd">Theorem 5.0.3</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.minpoly_dvd_prod_cyclotomic_of_dvd_X_pow_sub_one" class="lean_decl">Crystallographic.minpoly_dvd_prod_cyclotomic_of_dvd_X_pow_sub_one</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>     If \(\mu _A \mid X^m - 1\) and \(S = \{ d \mid m : \Phi _d \mid \mu _A\} \), then \(\mu _A \mid \prod _{d \in S} \Phi _d\).  </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000047">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p>Split \(X^m - 1 = (\prod _{d \in S} \Phi _d) \cdot (\prod _{d \notin S} \Phi _d)\). Since \(\Phi _d\) is irreducible and does not divide \(\mu _A\) for \(d \notin S\), we have \(\gcd (\mu _A, \Phi _d) = 1\). Thus \(\mu _A\) is coprime to \(\prod _{d \notin S} \Phi _d\). Since \(\mu _A \mid X^m - 1\), it must divide \(\prod _{d \in S} \Phi _d\). </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">lemma minpoly_dvd_prod_cyclotomic_of_dvd_X_pow_sub_one {N : ℕ} [NeZero N]</span></code><code class="lean-proof-body"><span class="lean-plain">{N : ℕ} [NeZero N]
    (A : Matrix (Fin N) (Fin N) ℤ) (m : ℕ) (hm : 0 &lt; m) (S : Finset ℕ) (hS_sub : S ⊆ m.divisors)
    (hS_def : ∀ d ∈ m.divisors, d ∈ S ↔ cyclotomic d ℚ ∣ minpoly ℚ (A.map (algebraMap ℤ ℚ)))
    (hminpoly_dvd : minpoly ℚ (A.map (algebraMap ℤ ℚ)) ∣ X ^ m - 1) :
    minpoly ℚ (A.map (algebraMap ℤ ℚ)) ∣ ∏ d ∈ S, cyclotomic d ℚ := by
  let A_Q := A.map (algebraMap ℤ ℚ)
  -- Key: {x ∈ m.divisors | x ∈ S} = S since S ⊆ m.divisors
  have hS_eq : m.divisors.filter (· ∈ S) = S := by
    ext d
    simp only [Finset.mem_filter]
    exact ⟨fun ⟨_, hd⟩ =&gt; hd, fun hd =&gt; ⟨hS_sub hd, hd⟩⟩
  -- minpoly is coprime to the product of cyclotomics NOT in S
  have hcoprime_with_complement : IsCoprime (minpoly ℚ A_Q)
      (∏ d ∈ m.divisors.filter (· ∉ S), cyclotomic d ℚ) :=
    IsCoprime.prod_right fun d hd =&gt; by
      have hd_div := (Finset.mem_filter.mp hd).1
      have hd_not_in_S := (Finset.mem_filter.mp hd).2
      have hndvd : ¬cyclotomic d ℚ ∣ minpoly ℚ A_Q := fun hdvd =&gt;
        hd_not_in_S ((hS_def d hd_div).mpr hdvd)
      exact (cyclotomic_coprime_minpoly_of_not_mem A d (Nat.pos_of_mem_divisors hd_div) hndvd).symm
  -- Split X^m - 1 = (∏_{d∈S} Φ_d) * (∏_{d∉S} Φ_d)
  have hprod_split : ∏ d ∈ m.divisors, cyclotomic d ℚ =
      (∏ d ∈ S, cyclotomic d ℚ) * (∏ d ∈ m.divisors.filter (· ∉ S), cyclotomic d ℚ) := by
    rw [← Finset.prod_filter_mul_prod_filter_not m.divisors (· ∈ S), hS_eq]
  rw [← prod_cyclotomic_eq_X_pow_sub_one hm, hprod_split] at hminpoly_dvd
  exact hcoprime_with_complement.dvd_of_dvd_mul_right hminpoly_dvd</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Forward.lean#L140-L140" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="lem:minpoly-eq-prod-cyclotomic">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.5</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#lem:minpoly-eq-prod-cyclotomic">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000048"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0005.html#lem:minpoly-dvd-prod-cyclotomic">Theorem 5.0.4</a></li>
          
          <li><a href="sect0005.html#lem:cyclotomic-finset-product-dvd">Theorem 5.0.3</a></li>
          
          <li><a href="sect0005.html#lem:cyclotomic-finset-product-dvd">Theorem 5.0.3</a></li>
          
          <li><a href="sect0005.html#lem:minpoly-dvd-prod-cyclotomic">Theorem 5.0.4</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.minpoly_eq_prod_cyclotomic_of_dvd_X_pow_sub_one" class="lean_decl">Crystallographic.minpoly_eq_prod_cyclotomic_of_dvd_X_pow_sub_one</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>     If \(\mu _A \mid X^m - 1\), then there exists \(S \subseteq \mathrm{divisors}(m)\) such that \(\mu _A = \prod _{d \in S} \Phi _d\).  </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000048">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p> Let \(S = \{ d \mid m : \Phi _d \mid \mu _A\} \). By the previous lemma, \(\mu _A \mid \prod _{d \in S} \Phi _d\). Conversely, by definition of \(S\), each \(\Phi _d\) for \(d \in S\) divides \(\mu _A\), so their coprime product divides \(\mu _A\). Mutual divisibility of monic polynomials implies equality. </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">lemma minpoly_eq_prod_cyclotomic_of_dvd_X_pow_sub_one {N : ℕ} [NeZero N]</span></code><code class="lean-proof-body"><span class="lean-plain">{N : ℕ} [NeZero N]
    (A : Matrix (Fin N) (Fin N) ℤ) (m : ℕ) (hm : 0 &lt; m)
    (hminpoly_dvd : minpoly ℚ (A.map (algebraMap ℤ ℚ)) ∣ X ^ m - 1) :
    ∃ S : Finset ℕ, (∀ d ∈ S, d ∣ m) ∧
      minpoly ℚ (A.map (algebraMap ℤ ℚ)) = ∏ d ∈ S, cyclotomic d ℚ := by
  classical
  let A_Q := A.map (algebraMap ℤ ℚ)
  let S := m.divisors.filter (fun d =&gt; cyclotomic d ℚ ∣ minpoly ℚ A_Q)
  have hS_sub : S ⊆ m.divisors := Finset.filter_subset _ _
  have hS_dvd : ∀ d ∈ S, d ∣ m := fun d hd =&gt;
    (Nat.mem_divisors.mp (Finset.mem_filter.mp hd).1).1
  have hS_def : ∀ d ∈ m.divisors, d ∈ S ↔ cyclotomic d ℚ ∣ minpoly ℚ A_Q := fun d hd =&gt;
    ⟨fun hS =&gt; (Finset.mem_filter.mp hS).2, fun hdvd =&gt; Finset.mem_filter.mpr ⟨hd, hdvd⟩⟩
  -- minpoly ∣ ∏_{d∈S} Φ_d (by coprimality argument)
  have hminpoly_dvd_prod : minpoly ℚ A_Q ∣ ∏ d ∈ S, cyclotomic d ℚ :=
    minpoly_dvd_prod_cyclotomic_of_dvd_X_pow_sub_one A m hm S hS_sub hS_def hminpoly_dvd
  -- ∏_{d∈S} Φ_d ∣ minpoly (by definition of S)
  have hprod_dvd_minpoly : (∏ d ∈ S, cyclotomic d ℚ) ∣ minpoly ℚ A_Q :=
    cyclotomic_finset_product_dvd S (fun d hd =&gt; (Finset.mem_filter.mp hd).2)
  -- Equality by mutual divisibility of monic polynomials
  exact ⟨S, hS_dvd, Polynomial.eq_of_monic_of_associated
    (minpoly.monic (Matrix.isIntegral A_Q))
    (Polynomial.monic_prod_of_monic _ _ (fun d _ =&gt; cyclotomic.monic d ℚ))
    (associated_of_dvd_dvd hminpoly_dvd_prod hprod_dvd_minpoly)⟩</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Forward.lean#L178-L178" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="lem:cyclotomic-divisors-lcm-eq">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.6</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#lem:cyclotomic-divisors-lcm-eq">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000049"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0005.html#lem:minpoly-eq-prod-cyclotomic">Theorem 5.0.5</a></li>
          
          <li><a href="sect0005.html#lem:pow-eq-one-of-minpoly-dvd">Theorem 5.0.1</a></li>
          
          <li><a href="sect0005.html#lem:cyclotomic-finset-product-dvd">Theorem 5.0.3</a></li>
          
          <li><a href="sect0005.html#lem:pow-eq-one-of-minpoly-dvd">Theorem 5.0.1</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.cyclotomic_divisors_lcm_eq_of_orderOf" class="lean_decl">Crystallographic.cyclotomic_divisors_lcm_eq_of_orderOf</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>     If \(\mathrm{ord}(A) = m\) and \(\mu _A = \prod _{d \in S} \Phi _d\) with \(S \subseteq \mathrm{divisors}(m)\), then \(\mathrm{lcm}(S) = m\).  </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000049">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p> Suppose \(\ell = \mathrm{lcm}(S) {\lt} m\). Then \(\mu _A = \prod _{d \in S} \Phi _d\) divides \(\prod _{d \mid \ell } \Phi _d = X^\ell - 1\), since each \(d \in S\) divides \(\ell \). By the transfer lemma, \(A^\ell = I\). But this contradicts \(\mathrm{ord}(A) = m {\gt} \ell \). </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">lemma cyclotomic_divisors_lcm_eq_of_orderOf {N : ℕ} [NeZero N]</span></code><code class="lean-proof-body"><span class="lean-plain">{N : ℕ} [NeZero N]
    (A : Matrix (Fin N) (Fin N) ℤ) (m : ℕ) (hm : 0 &lt; m) (hA_ord : orderOf A = m)
    (S : Finset ℕ) (hS_sub : ∀ d ∈ S, d ∣ m)
    (hminpoly_eq_prod : minpoly ℚ (A.map (algebraMap ℤ ℚ)) = ∏ d ∈ S, cyclotomic d ℚ) :
    S.lcm id = m := by
  let A_Q := A.map (algebraMap ℤ ℚ)
  -- If lcm(S) &lt; m, then minpoly | X^{lcm(S)} - 1, so A^{lcm(S)} = 1
  -- This contradicts orderOf A = m
  by_contra hne
  have hlcm_dvd_m : S.lcm id ∣ m := Finset.lcm_dvd (fun d hd =&gt; hS_sub d hd)
  have hlcm_le : S.lcm id ≤ m := Nat.le_of_dvd hm hlcm_dvd_m
  have hlcm_lt : S.lcm id &lt; m := Nat.lt_of_le_of_ne hlcm_le hne
  -- minpoly | ∏_{d|lcm(S)} Φ_d = X^{lcm(S)} - 1
  have hlcm_pos : 0 &lt; S.lcm id := by
    by_cases hS_empty : S = ∅
    · -- If S = ∅, then minpoly = 1 (empty product), contradiction since
      -- minpoly has positive degree
      simp only [hS_empty, Finset.prod_empty] at hminpoly_eq_prod
      have hdeg := minpoly.natDegree_pos (Matrix.isIntegral A_Q)
      rw [hminpoly_eq_prod, natDegree_one] at hdeg
      omega
    · have hne_zero : S.lcm id ≠ 0 := Finset.lcm_ne_zero_iff.mpr fun d hd =&gt;
        (Nat.pos_of_mem_divisors (Nat.mem_divisors.mpr ⟨hS_sub d hd, hm.ne&#x27;⟩)).ne&#x27;
      exact Nat.pos_of_ne_zero hne_zero
  -- Helper: X^d - 1 | X^n - 1 when d | n
  have X_pow_sub_one_dvd : ∀ (d n : ℕ), d ∣ n → (X ^ d - 1 : ℚ[X]) ∣ X ^ n - 1 := by
    intro d n hdvd
    obtain ⟨k, hk⟩ := hdvd
    rw [hk]
    exact pow_one_sub_dvd_pow_mul_sub_one X d k
  have hminpoly_dvd_lcm : minpoly ℚ A_Q ∣ X ^ (S.lcm id) - 1 := by
    rw [hminpoly_eq_prod]
    apply cyclotomic_finset_product_dvd
    intro d hd
    have hd_dvd_lcm : d ∣ S.lcm id := Finset.dvd_lcm hd
    calc cyclotomic d ℚ ∣ X ^ d - 1 := cyclotomic.dvd_X_pow_sub_one d ℚ
      _ ∣ X ^ (S.lcm id) - 1 := X_pow_sub_one_dvd d (S.lcm id) hd_dvd_lcm
  -- Therefore A^{lcm(S)} = 1
  have hpow_lcm : A ^ (S.lcm id) = 1 :=
    Matrix.pow_eq_one_of_minpoly_dvd_X_pow_sub_one A (S.lcm id) hminpoly_dvd_lcm
  -- But orderOf A = m &gt; lcm(S), so orderOf A | lcm(S) is false
  have hord_dvd := orderOf_dvd_of_pow_eq_one hpow_lcm
  rw [hA_ord] at hord_dvd
  have := Nat.le_of_dvd hlcm_pos hord_dvd
  omega</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Forward.lean#L213-L213" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="thm:forward-direction">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.7</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#thm:forward-direction">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000050"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0003.html#integerMatrixOrders-def">Definition 3.0.1</a></li>
          
          <li><a href="sect0002.html#psi-def">Definition 2.0.2</a></li>
          
          <li><a href="sect0002.html#lem:sum-totient-ge-psi">Theorem 2.0.12</a></li>
          
          <li><a href="sect0005.html#lem:minpoly-eq-prod-cyclotomic">Theorem 5.0.5</a></li>
          
          <li><a href="sect0002.html#psiPrimePow-def">Definition 2.0.1</a></li>
          
          <li><a href="sect0005.html#lem:cyclotomic-divisors-lcm-eq">Theorem 5.0.6</a></li>
          
          <li><a href="sect0002.html#lem:sum-totient-ge-psi">Theorem 2.0.12</a></li>
          
          <li><a href="sect0005.html#lem:minpoly-dvd-X-pow-sub-one">Theorem 5.0.2</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.psi_le_of_mem_integerMatrixOrders" class="lean_decl">Crystallographic.psi_le_of_mem_integerMatrixOrders</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>      <b class="bfseries">Forward Direction:</b> If \(m \in \mathrm{Ord}_N\), then \(\psi (m) \leq N\). </p>
<p><b class="bfseries">Mathematical context:</b> The key insight is that integer matrices with finite order have constrained eigenvalues: if \(A^m = I\), all eigenvalues are \(m\)-th roots of unity. The minimal polynomial over \(\mathbb {Q}\) factors into cyclotomic polynomials \(\Phi _d\) for various divisors \(d\) of \(m\). The requirement that \(\mathrm{ord}(A) = m\) (not some proper divisor) forces the set of cyclotomic factors to have \(\mathrm{lcm} = m\), which constrains the total degree. </p>
<p><b class="bfseries">Proof outline:</b> </p>
<ol class="enumerate">
  <li><p>Let \(A\) be an \(N \times N\) integer matrix with \(\mathrm{ord}(A) = m\). </p>
</li>
  <li><p>The minimal polynomial of \(A\) over \(\mathbb {Q}\) divides \(X^m - 1 = \prod _{d \mid m} \Phi _d\). </p>
</li>
  <li><p>Since \(\Phi _d\) are irreducible and pairwise coprime over \(\mathbb {Q}\), the minimal polynomial equals \(\prod _{d \in S} \Phi _d\) for some \(S \subseteq \mathrm{divisors}(m)\). </p>
</li>
  <li><p>The condition \(\mathrm{ord}(A) = m\) forces \(\mathrm{lcm}(S) = m\): if \(\mathrm{lcm}(S) {\lt} m\), then \(A^{\mathrm{lcm}(S)} = I\), contradicting \(\mathrm{ord}(A) = m\). </p>
</li>
  <li><p>The degree of the minimal polynomial is \(\sum _{d \in S} \varphi (d)\). </p>
</li>
  <li><p>By the sum-totient lemma (applied to any \(S\) with \(\mathrm{lcm}(S) = m\)), \(\psi (m) \leq \sum _{d \in S} \varphi (d) = \deg (\mathrm{minpoly}) \leq \deg (\mathrm{charpoly}) = N\). </p>
</li>
</ol>


    </div>
    <div class="proof_wrapper proof_inline" id="a0000000050">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p> Let \(A\) be an \(N \times N\) integer matrix with \(A^m = I\). The minimal polynomial \(\mu _A\) over \(\mathbb {Q}\) divides \(X^m - 1\) and factors into cyclotomic polynomials \(\Phi _d\) for various \(d \mid m\). Each factor contributes \(\varphi (d)\) to \(\deg (\mu _A) \leq N\). Since distinct \(\Phi _d\) are coprime and their lcm must be \(m\), summing the totients of appearing divisors gives \(\psi (m) \leq N\). - </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">theorem psi_le_of_mem_integerMatrixOrders (N m : ℕ) (hm : 0 &lt; m)</span></code><code class="lean-proof-body"><span class="lean-plain">(N m : ℕ) (hm : 0 &lt; m)
    (hord : m ∈ integerMatrixOrders N) : Crystallographic.psi m ≤ N := by
  -- Extract the matrix A with orderOf A = m
  obtain ⟨A, hA_ord, _⟩ := hord
  -- Handle the case N = 0 separately
  rcases Nat.eq_zero_or_pos N with rfl | hN_pos
  · -- N = 0: The only 0×0 matrix is empty, with order 1
    haveI : IsEmpty (Fin 0) := Fin.isEmpty
    have hA_eq_1 : A = 1 := Matrix.ext fun i =&gt; Fin.elim0 i
    rw [hA_eq_1, orderOf_one] at hA_ord
    subst hA_ord
    simp [Crystallographic.psi_one]
  · -- N &gt; 0: Use psi ≤ deg(minpoly) ≤ deg(charpoly) = N
    haveI : NeZero N := ⟨Nat.pos_iff_ne_zero.mp hN_pos⟩
    let A_Q := A.map (algebraMap ℤ ℚ)
    -- The minimal polynomial degree is at most N
    have hminpoly_deg_le : (minpoly ℚ A_Q).natDegree ≤ N := by
      have hdvd := Matrix.minpoly_dvd_charpoly A_Q
      have hne : A_Q.charpoly ≠ 0 := (Matrix.charpoly_monic A_Q).ne_zero
      calc (minpoly ℚ A_Q).natDegree ≤ A_Q.charpoly.natDegree :=
          Polynomial.natDegree_le_of_dvd hdvd hne
        _ = Fintype.card (Fin N) := Matrix.charpoly_natDegree_eq_dim A_Q
        _ = N := Fintype.card_fin N
    -- minpoly | X^m - 1 since A^m = 1
    have hpow : A ^ m = 1 := by rw [← hA_ord]; exact pow_orderOf_eq_one A
    have hminpoly_dvd : minpoly ℚ A_Q ∣ X ^ m - 1 :=
      Matrix.minpoly_dvd_X_pow_sub_one_of_pow_eq_one A m hpow
    -- Get S and the product decomposition from helper lemma
    obtain ⟨S, hS_sub, hminpoly_eq_prod⟩ :=
      minpoly_eq_prod_cyclotomic_of_dvd_X_pow_sub_one A m hm hminpoly_dvd
    -- The lcm of S equals m (otherwise order would be smaller)
    have hS_lcm : S.lcm id = m :=
      cyclotomic_divisors_lcm_eq_of_orderOf A m hm hA_ord S hS_sub hminpoly_eq_prod
    -- Compute the degree as sum of totients
    have hdeg_eq : (minpoly ℚ A_Q).natDegree = ∑ d ∈ S, Nat.totient d := by
      rw [hminpoly_eq_prod, Polynomial.natDegree_prod _ _ (fun d _ =&gt; cyclotomic_ne_zero d ℚ)]
      exact Finset.sum_congr rfl (fun d _ =&gt; natDegree_cyclotomic d ℚ)
    -- Apply sum_totient_ge_psi_of_lcm_eq
    calc Crystallographic.psi m ≤ ∑ d ∈ S, Nat.totient d :=
        sum_totient_ge_psi_of_lcm_eq m hm S hS_sub hS_lcm
      _ = (minpoly ℚ A_Q).natDegree := hdeg_eq.symm
      _ ≤ N := hminpoly_deg_le</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Forward.lean#L305-L305" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="lem:permMatrix-one">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.8</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#lem:permMatrix-one">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000051"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.Equiv.Perm.permMatrix_one" class="lean_decl">Crystallographic.Equiv.Perm.permMatrix_one</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>     The permutation matrix of the identity is the identity matrix: \(P_{\mathrm{id}} = I\). </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000051">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p>Direct computation using \(\mathrm{toPEquiv}(\mathrm{id}) = \mathrm{refl}\) and \(\mathrm{toMatrix}(\mathrm{refl}) = I\). </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">lemma permMatrix_one {n : Type*} [DecidableEq n] {R : Type*} [Zero R] [One R] :</span></code><code class="lean-proof-body"><span class="lean-plain">{n : Type*} [DecidableEq n] {R : Type*} [Zero R] [One R] :
    (1 : Equiv.Perm n).permMatrix R = (1 : Matrix n n R) := by
  simp only [Equiv.Perm.permMatrix, Equiv.Perm.one_def, Equiv.toPEquiv_refl, PEquiv.toMatrix_refl]</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Backward.lean#L72-L72" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="lem:permMatrix-mul">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.9</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#lem:permMatrix-mul">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000052"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.Equiv.Perm.permMatrix_mul" class="lean_decl">Crystallographic.Equiv.Perm.permMatrix_mul</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>     Permutation matrices satisfy \(P_{\sigma \cdot \tau } = P_\tau \cdot P_\sigma \) (contravariant homomorphism). </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000052">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p>Follows from \(\mathrm{toPEquiv}(\sigma \circ \tau ) = \mathrm{toPEquiv}(\tau ) \cdot \mathrm{toPEquiv}(\sigma )\) and the corresponding property for partial equivalence matrices. </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">lemma permMatrix_mul {n : Type*} [DecidableEq n] [Fintype n] {R : Type*} [Semiring R]</span></code><code class="lean-proof-body"><span class="lean-plain">{n : Type*} [DecidableEq n] [Fintype n] {R : Type*} [Semiring R]
    (σ τ : Equiv.Perm n) :
    (σ * τ).permMatrix R = τ.permMatrix R * σ.permMatrix R := by
  simp only [Equiv.Perm.permMatrix]
  rw [Equiv.Perm.mul_def, Equiv.toPEquiv_trans, PEquiv.toMatrix_trans]</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Backward.lean#L82-L82" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="lem:permMatrix-pow">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.10</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#lem:permMatrix-pow">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000053"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0005.html#lem:permMatrix-one">Theorem 5.0.8</a></li>
          
          <li><a href="sect0005.html#lem:permMatrix-mul">Theorem 5.0.9</a></li>
          
          <li><a href="sect0005.html#lem:permMatrix-one">Theorem 5.0.8</a></li>
          
          <li><a href="sect0005.html#lem:permMatrix-mul">Theorem 5.0.9</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.Equiv.Perm.permMatrix_pow" class="lean_decl">Crystallographic.Equiv.Perm.permMatrix_pow</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>     Powers of permutation matrices satisfy \(P_{\sigma ^k} = P_\sigma ^k\).  </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000053">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p> By induction on \(k\): the base case uses \(P_{\mathrm{id}} = I\), and the inductive step uses \(P_{\sigma \cdot \tau } = P_\tau \cdot P_\sigma \) together with commutativity of powers. </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">lemma permMatrix_pow {n : Type*} [DecidableEq n] [Fintype n] {R : Type*} [Semiring R]</span></code><code class="lean-proof-body"><span class="lean-plain">{n : Type*} [DecidableEq n] [Fintype n] {R : Type*} [Semiring R]
    (σ : Equiv.Perm n) (k : ℕ) :
    (σ ^ k).permMatrix R = (σ.permMatrix R) ^ k := by
  induction k with
  | zero =&gt; simp [permMatrix_one]
  | succ k ih =&gt;
    rw [pow_succ, pow_succ, permMatrix_mul, ih]
    -- Goal: σ.permMatrix * (σ.permMatrix)^k = (σ.permMatrix)^k * σ.permMatrix
    -- Use SemiconjBy or direct equality - both sides are equal
    exact (Commute.pow_self (σ.permMatrix R) k).eq.symm</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Backward.lean#L94-L94" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="lem:permMatrix-eq-one-iff">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.11</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#lem:permMatrix-eq-one-iff">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000054"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0005.html#lem:permMatrix-one">Theorem 5.0.8</a></li>
          
          <li><a href="sect0005.html#lem:permMatrix-one">Theorem 5.0.8</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.Equiv.Perm.permMatrix_eq_one_iff" class="lean_decl">Crystallographic.Equiv.Perm.permMatrix_eq_one_iff</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>     \(P_\sigma = I\) if and only if \(\sigma = \mathrm{id}\).  </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000054">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p> The forward direction shows that if \(P_\sigma = I\) then for each \(x\), the entry \((P_\sigma )_{x, \sigma (x)} = 1\) forces \(\sigma (x) = x\). The reverse is immediate from \(P_{\mathrm{id}} = I\). </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">lemma permMatrix_eq_one_iff {n : Type*} [DecidableEq n] [Fintype n] {R : Type*} [Semiring R]</span></code><code class="lean-proof-body"><span class="lean-plain">{n : Type*} [DecidableEq n] [Fintype n] {R : Type*} [Semiring R]
    [Nontrivial R] (σ : Equiv.Perm n) :
    σ.permMatrix R = 1 ↔ σ = 1 := by
  constructor
  · intro h
    ext x
    have hx := congrFun (congrFun h x) (σ x)
    simp only [Equiv.Perm.permMatrix, Equiv.toPEquiv_apply, PEquiv.toMatrix_apply, Matrix.one_apply,
      Option.mem_def] at hx
    by_cases hσx : σ x = x
    · exact hσx
    · exfalso
      -- hx says: if σ (σ x) = σ x then 1 else 0 = if x = σ x then 1 else 0
      -- After simp, lhs simplifies using σ (σ x) = σ x ↔ σ x = x (by injectivity)
      -- which is true since Option.mem_def
      -- rhs: x = σ x is false by hσx
      have h1 : (1 : R) = if x = σ x then 1 else 0 := hx
      rw [if_neg (ne_comm.mpr hσx)] at h1
      exact one_ne_zero h1
  · intro h; rw [h]; exact permMatrix_one</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Backward.lean#L112-L112" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="lem:orderOf-permMatrix">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.12</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#lem:orderOf-permMatrix">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000055"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.Equiv.Perm.orderOf_permMatrix" class="lean_decl">Crystallographic.Equiv.Perm.orderOf_permMatrix</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>     The order of \(P_\sigma \) equals the order of \(\sigma \) for a permutation matrix. </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000055">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p> Since \(P_{\sigma ^k} = P_\sigma ^k\) and \(P_\sigma = I \iff \sigma = \mathrm{id}\), the order of \(P_\sigma \) equals the order of \(\sigma \). The key is that the permutation matrix map preserves powers and is injective on the group of permutation matrices. </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">lemma orderOf_permMatrix {n : Type*} [DecidableEq n] [Fintype n] {R : Type*} [Semiring R]</span></code><code class="lean-proof-body"><span class="lean-plain">{n : Type*} [DecidableEq n] [Fintype n] {R : Type*} [Semiring R]
    [Nontrivial R] (σ : Equiv.Perm n) :
    orderOf (σ.permMatrix R) = orderOf σ := by
  rcases Nat.eq_zero_or_pos (orderOf σ) with hord | hord
  · -- σ has infinite order (orderOf σ = 0)
    rw [hord, orderOf_eq_zero_iff&#x27;]
    intro k hk heq
    have h1 : (σ ^ k).permMatrix R = 1 := by rw [permMatrix_pow]; exact heq
    rw [permMatrix_eq_one_iff] at h1
    exact (orderOf_eq_zero_iff&#x27;.mp hord) k hk h1
  · -- σ has finite order
    rw [orderOf_eq_iff hord]
    constructor
    · rw [← permMatrix_pow, pow_orderOf_eq_one]; exact permMatrix_one
    · intro k hk_lt hk_pos heq
      have hk&#x27; : (σ ^ k).permMatrix R = 1 := by rw [permMatrix_pow]; exact heq
      rw [permMatrix_eq_one_iff] at hk&#x27;
      have hdvd : orderOf σ ∣ k := orderOf_dvd_of_pow_eq_one hk&#x27;
      exact Nat.not_lt.mpr (Nat.le_of_dvd hk_pos hdvd) hk_lt</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Backward.lean#L139-L139" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="lem:orderOf-finRotate">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.13</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#lem:orderOf-finRotate">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000056"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.Equiv.Perm.orderOf_finRotate" class="lean_decl">Crystallographic.Equiv.Perm.orderOf_finRotate</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>     The order of \(\mathrm{finRotate}(n)\) equals \(n\). </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000056">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p>The \(\mathrm{finRotate}(n)\) permutation is an \(n\)-cycle with full support \(\mathrm{Fin}\  n\). By the cycle order theorem, the order of a cycle equals its length, which is \(n\). </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">lemma orderOf_finRotate (n : ℕ) (hn : 2 ≤ n) : orderOf (finRotate n) = n := by</span></code><code class="lean-proof-body"><span class="lean-plain">(n : ℕ) (hn : 2 ≤ n) : orderOf (finRotate n) = n := by
  have hcycle := isCycle_finRotate_of_le hn
  have hord := Equiv.Perm.IsCycle.orderOf hcycle
  have hsupp := support_finRotate_of_le hn
  rw [hord, hsupp, Finset.card_univ, Fintype.card_fin]</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Backward.lean#L164-L164" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="lem:orderOf-permMatrix-finRotate">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.14</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#lem:orderOf-permMatrix-finRotate">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000057"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0005.html#lem:orderOf-permMatrix">Theorem 5.0.12</a></li>
          
          <li><a href="sect0005.html#lem:orderOf-finRotate">Theorem 5.0.13</a></li>
          
          <li><a href="sect0005.html#lem:orderOf-finRotate">Theorem 5.0.13</a></li>
          
          <li><a href="sect0005.html#lem:orderOf-permMatrix">Theorem 5.0.12</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.Equiv.Perm.orderOf_permMatrix_finRotate" class="lean_decl">Crystallographic.Equiv.Perm.orderOf_permMatrix_finRotate</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>     The permutation matrix of \(\mathrm{finRotate}(n)\) has order \(n\) over \(\mathbb {Z}\).  </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000057">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p> Combines the order-preservation property \(\mathrm{ord}(P_\sigma ) = \mathrm{ord}(\sigma )\) with \(\mathrm{ord}(\mathrm{finRotate}(n)) = n\). </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">lemma orderOf_permMatrix_finRotate (n : ℕ) (hn : 2 ≤ n) :</span></code><code class="lean-proof-body"><span class="lean-plain">(n : ℕ) (hn : 2 ≤ n) :
    orderOf ((finRotate n).permMatrix ℤ) = n := by
  rw [orderOf_permMatrix, orderOf_finRotate n hn]</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Backward.lean#L176-L176" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="lem:mem-integerMatrixOrders-self">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.15</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#lem:mem-integerMatrixOrders-self">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000058"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0003.html#integerMatrixOrders-def">Definition 3.0.1</a></li>
          
          <li><a href="sect0005.html#lem:orderOf-permMatrix-finRotate">Theorem 5.0.14</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.mem_integerMatrixOrders_self" class="lean_decl">Crystallographic.mem_integerMatrixOrders_self</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>      \(m \in \mathrm{Ord}_m\) for \(m \geq 2\) via permutation matrix. </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000058">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p> The permutation matrix \(P_{\mathrm{finRotate}(m)}\) is an \(m \times m\) integer matrix with order exactly \(m\), since \(\mathrm{finRotate}(m)\) has order \(m\). </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">lemma mem_integerMatrixOrders_self (n : ℕ) (hn : 2 ≤ n) : n ∈ integerMatrixOrders n := by</span></code><code class="lean-proof-body"><span class="lean-plain">(n : ℕ) (hn : 2 ≤ n) : n ∈ integerMatrixOrders n := by
  use (finRotate n).permMatrix ℤ
  constructor
  · exact Equiv.Perm.orderOf_permMatrix_finRotate n hn
  · omega</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Backward.lean#L187-L187" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="thm:primePow-mem-integerMatrixOrders-psi">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.16</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#thm:primePow-mem-integerMatrixOrders-psi">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000059"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0002.html#psi-def">Definition 2.0.2</a></li>
          
          <li><a href="sect0003.html#integerMatrixOrders-def">Definition 3.0.1</a></li>
          
          <li><a href="sect0002.html#lem:psi-prime-pow">Theorem 2.0.1</a></li>
          
          <li><a href="sect0004.html#thm:mem-orders-totient">Theorem 4.0.7</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.primePow_mem_integerMatrixOrders_psi" class="lean_decl">Crystallographic.primePow_mem_integerMatrixOrders_psi</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>      For a prime power \(p^k\) with \(p\) odd or \(k \geq 2\), we have \(p^k \in \mathrm{Ord}_{\psi (p^k)}\). </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000059">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p> For these prime powers, \(\psi (p^k) = \varphi (p^k)\). The companion matrix of \(\Phi _{p^k}\) has dimension \(\varphi (p^k)\) and order exactly \(p^k\), so \(p^k \in \mathrm{Ord}_{\varphi (p^k)} = \mathrm{Ord}_{\psi (p^k)}\). </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">theorem primePow_mem_integerMatrixOrders_psi (p k : ℕ) (hp : p.Prime) (hk : 0 &lt; k)</span></code><code class="lean-proof-body"><span class="lean-plain">(p k : ℕ) (hp : p.Prime) (hk : 0 &lt; k)
    (hpk : ¬(p = 2 ∧ k = 1)) :
    p ^ k ∈ integerMatrixOrders (psi (p ^ k)) := by
  -- psi(p^k) = totient(p^k) for this case
  have hpsi_eq : psi (p ^ k) = Nat.totient (p ^ k) := by
    rw [psi_prime_pow p k hp hk]
    simp only [hpk, ite_false]
  rw [hpsi_eq]
  -- Use companion matrix lemma
  have hpk_ge2 : 2 ≤ p ^ k := by
    have hp_ge2 : 2 ≤ p := hp.two_le
    calc p ^ k ≥ p ^ 1 := Nat.pow_le_pow_right (Nat.le_of_lt hp.one_lt) hk
      _ = p := pow_one p
      _ ≥ 2 := hp_ge2
  exact mem_integerMatrixOrders_totient (p ^ k) hpk_ge2</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Backward.lean#L201-L201" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="thm:mem-integerMatrixOrders-psi">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.17</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#thm:mem-integerMatrixOrders-psi">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000060"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0005.html#thm:primePow-mem-integerMatrixOrders-psi">Theorem 5.0.16</a></li>
          
          <li><a href="sect0002.html#psi-def">Definition 2.0.2</a></li>
          
          <li><a href="sect0003.html#lem:one-mem-orders">Theorem 3.0.1</a></li>
          
          <li><a href="sect0006.html#lem:orderOf-neg-of-odd-order">Theorem A.0.7</a></li>
          
          <li><a href="sect0002.html#psiPrimePow-def">Definition 2.0.1</a></li>
          
          <li><a href="sect0003.html#lem:mul-mem-orders-coprime">Theorem 3.0.10</a></li>
          
          <li><a href="sect0005.html#thm:primePow-mem-integerMatrixOrders-psi">Theorem 5.0.16</a></li>
          
          <li><a href="sect0002.html#lem:factorization-split-lt">Theorem 2.0.6</a></li>
          
          <li><a href="sect0002.html#lem:psi-coprime-add">Theorem 2.0.3</a></li>
          
          <li><a href="sect0003.html#lem:one-mem-orders">Theorem 3.0.1</a></li>
          
          <li><a href="sect0002.html#lem:psi-pos-of-odd">Theorem 2.0.7</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.mem_integerMatrixOrders_psi" class="lean_decl">Crystallographic.mem_integerMatrixOrders_psi</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>      For \(m \geq 1\) with \(m \neq 2\), we have \(m \in \mathrm{Ord}_{\psi (m)}\). The construction achieves order \(m\) using exactly \(\psi (m)\) dimensions via block diagonal matrices of cyclotomic companion matrices.  </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000060">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p> By strong induction on \(m\). For \(m = 1\), the identity achieves order 1 in dimension \(\psi (1) = 0\). For prime powers \(p^k\) (excluding \(2^1\)), the companion matrix of \(\Phi _{p^k}\) has order \(p^k\) in dimension \(\varphi (p^k) = \psi (p^k)\). For composite \(m = p^e \cdot m'\) with coprime factors, we use block diagonal of matrices achieving orders \(p^e\) and \(m'\) from the induction hypothesis, with dimension \(\psi (p^e) + \psi (m') = \psi (m)\) by additivity of \(\psi \) on coprime factors. For \(m = 2 \cdot m'\) with \(m'\) odd, negating the order-\(m'\) matrix doubles the order without changing dimension. </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">theorem mem_integerMatrixOrders_psi (m : ℕ) (hm : 0 &lt; m) (hm2 : m ≠ 2) :</span></code><code class="lean-proof-body"><span class="lean-plain">(m : ℕ) (hm : 0 &lt; m) (hm2 : m ≠ 2) :
    m ∈ integerMatrixOrders (psi m) := by
  -- Use strong induction on m
  induction m using Nat.strong_induction_on with
  | _ m IH =&gt;
  -- Case: m = 1
  rcases (Nat.one_le_iff_ne_zero.mpr hm.ne&#x27;).eq_or_lt&#x27; with rfl | hm_gt1
  · simp only [psi_one]; exact one_mem_integerMatrixOrders 0
  · -- Case: m &gt; 1, i.e., m &gt;= 2
    have hm_gt2 : 2 &lt; m := by omega
    -- Check if m is a prime power
    by_cases hpow : IsPrimePow m
    · -- m is a prime power p^k
      rw [isPrimePow_nat_iff] at hpow
      obtain ⟨p, k, hp, hk, hpk⟩ := hpow
      subst hpk
      by_cases h21 : p = 2 ∧ k = 1
      · obtain ⟨rfl, rfl⟩ := h21; simp only [pow_one] at hm_gt2; omega
      · exact primePow_mem_integerMatrixOrders_psi p k hp hk h21
    · -- m is not a prime power: use factorization_split_lt
      obtain ⟨p, e, m&#x27;, hp, he_pos, hm_eq, hcop, _, hm&#x27;_lt, _⟩ :=
        factorization_split_lt (by omega : 2 &lt; m) hpow
      by_cases h_pe_is_2 : p = 2 ∧ e = 1
      · -- p^e = 2, so m = 2 * m&#x27; with m&#x27; odd
        have hcop&#x27; : Nat.Coprime 2 m&#x27; := by simp only [h_pe_is_2.1, h_pe_is_2.2, pow_one] at hcop ⊢; exact hcop
        have ⟨hm&#x27;_odd, hm&#x27;_ne_2, hm&#x27;_ge3⟩ := odd_ne_two_ge_three_of_coprime_two hcop&#x27; (by omega)
        rw [show m = 2 * m&#x27; by simp only [h_pe_is_2.1, h_pe_is_2.2, pow_one] at hm_eq; omega]
        exact mem_integerMatrixOrders_psi_2_times_odd m&#x27; (by omega) hm&#x27;_odd hm&#x27;_ge3
          (IH m&#x27; hm&#x27;_lt (by omega) hm&#x27;_ne_2)
      · by_cases hm&#x27;_eq_2 : m&#x27; = 2
        · -- m&#x27; = 2, so m = p^e * 2 with p^e odd
          have ⟨hpe_odd, hpe_ge3⟩ := primePow_odd_ge_three_of_coprime_two hp he_pos (hm&#x27;_eq_2 ▸ hcop)
          rw [← hm_eq, hm&#x27;_eq_2]
          exact mem_integerMatrixOrders_psi_odd_times_2 (p ^ e) (Nat.pow_pos hp.pos) hpe_odd hpe_ge3
            (primePow_mem_integerMatrixOrders_psi p e hp he_pos h_pe_is_2)
        · -- Neither is 2, use block diagonal construction
          rw [← hm_eq]
          exact mem_integerMatrixOrders_psi_composite p e m&#x27; hp (by omega) hcop
            (primePow_mem_integerMatrixOrders_psi p e hp he_pos h_pe_is_2)
            (IH m&#x27; hm&#x27;_lt (by omega) hm&#x27;_eq_2)</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Backward.lean#L321-L321" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="thm:backward-direction">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.18</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#thm:backward-direction">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000061"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0003.html#integerMatrixOrders-def">Definition 3.0.1</a></li>
          
          <li><a href="sect0002.html#psi-def">Definition 2.0.2</a></li>
          
          <li><a href="sect0004.html#companion-def">Definition 4.0.1</a></li>
          
          <li><a href="sect0004.html#thm:companion-charpoly">Theorem 4.0.1</a></li>
          
          <li><a href="sect0004.html#thm:companion-cycl-order">Theorem 4.0.5</a></li>
          
          <li><a href="sect0004.html#thm:mem-orders-totient">Theorem 4.0.7</a></li>
          
          <li><a href="sect0002.html#psiPrimePow-def">Definition 2.0.1</a></li>
          
          <li><a href="sect0003.html#lem:orders-mono">Theorem 3.0.3</a></li>
          
          <li><a href="sect0002.html#lem:psi-prime-pow">Theorem 2.0.1</a></li>
          
          <li><a href="sect0004.html#thm:companion-cycl-mem">Theorem 4.0.6</a></li>
          
          <li><a href="sect0005.html#thm:mem-integerMatrixOrders-psi">Theorem 5.0.17</a></li>
          
          <li><a href="sect0005.html#lem:mem-integerMatrixOrders-self">Theorem 5.0.15</a></li>
          
          <li><a href="sect0002.html#lem:psi-coprime-add">Theorem 2.0.3</a></li>
          
          <li><a href="sect0004.html#thm:mem-orders-totient">Theorem 4.0.7</a></li>
          
          <li><a href="sect0003.html#lem:one-mem-orders">Theorem 3.0.1</a></li>
          
          <li><a href="sect0003.html#lem:two-mem-orders">Theorem 3.0.2</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.mem_integerMatrixOrders_of_psi_le" class="lean_decl">Crystallographic.mem_integerMatrixOrders_of_psi_le</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>      <b class="bfseries">Backward Direction:</b> If \(\psi (m) \leq N\), then \(m \in \mathrm{Ord}_N\). </p>
<p><b class="bfseries">Mathematical context:</b> The companion matrix of a monic polynomial \(p(X)\) has \(p(X)\) as both its characteristic and minimal polynomial. For the cyclotomic polynomial \(\Phi _m\), the companion matrix \(C_m\) satisfies \(\Phi _m(C_m) = 0\), so \(C_m^m = I\), and since \(\Phi _m\) is minimal (irreducible over \(\mathbb {Q}\) and dividing \(X^m - 1\) but not \(X^k - 1\) for \(k {\lt} m\)), we get \(\mathrm{ord}(C_m) = m\). The key optimization in the \(\psi \) function is that \(\psi (2) = 0\): order 2 is achieved by \(-I\) in any dimension, so we do not need to “pay” \(\varphi (2) = 1\) for the factor of 2. </p>
<p><b class="bfseries">Proof by explicit construction:</b> </p>
<ol class="enumerate">
  <li><p>For \(m = 1\): Use the identity matrix (any dimension). </p>
</li>
  <li><p>For \(m = 2\): Use \(-I\) (dimension \(\geq 1\)), achieving order 2 without adding to \(\psi \). </p>
</li>
  <li><p>For odd prime power \(p^k\): The companion matrix of \(\Phi _{p^k}\) has size \(\varphi (p^k)\). </p>
</li>
  <li><p>For \(2^k\) with \(k \geq 2\): The companion matrix of \(\Phi _{2^k}\) has size \(\varphi (2^k) = 2^{k-1}\). </p>
</li>
  <li><p>For \(m = 2m'\) with \(m'\) odd: If \(A\) has order \(m'\), then \(-A\) has order \(2m'\) (same dimension). </p>
</li>
  <li><p>For general \(m = \prod p_i^{k_i}\): Block diagonal of companion matrices for \(p_i^{k_i}\) with \(p_i \neq 2\) or \(k_i \geq 2\). The orders combine via \(\mathrm{lcm}\) (which equals the product for coprime factors), giving total order \(m\) in dimension \(\psi (m)\). </p>
</li>
  <li><p>Pad with identity blocks to reach size \(N \times N\) (padding does not change order). </p>
</li>
</ol>
<p>  - </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000061">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p> We construct a matrix of order \(m\) in dimension \(\psi (m)\) by taking block diagonals of companion matrices for cyclotomic polynomials \(\Phi _{p^k}\) of each prime power factor. The companion matrix \(C(\Phi _{p^k})\) has order exactly \(p^k\) and size \(\varphi (p^k)\). Block diagonal matrices have order equal to the lcm of block orders, which equals \(m\) for coprime factors. Identity padding extends to dimension \(N \geq \psi (m)\). - </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">theorem mem_integerMatrixOrders_of_psi_le (N m : ℕ) (hm : 0 &lt; m)</span></code><code class="lean-proof-body"><span class="lean-plain">(N m : ℕ) (hm : 0 &lt; m)
    (hpsi : psi m ≤ N) (hNm : m = 1 ∨ 0 &lt; N) :
    m ∈ integerMatrixOrders N := by
  -- Handle base cases m = 1, 2
  rcases Nat.lt_trichotomy m 2 with hm_lt2 | rfl | hm_gt2
  · -- m &lt; 2 and 0 &lt; m, so m = 1
    interval_cases m
    exact one_mem_integerMatrixOrders N
  · -- m = 2: use -I, need N &gt; 0
    cases hNm with
    | inl h =&gt; omega
    | inr hN_pos =&gt;
      haveI : NeZero N := ⟨Nat.pos_iff_ne_zero.mp hN_pos⟩
      exact two_mem_integerMatrixOrders N
  · -- m &gt; 2, i.e., m &gt;= 3
    -- If m ≤ N, use permutation matrix directly
    by_cases hle : m ≤ N
    · exact integerMatrixOrders_mono hle (mem_integerMatrixOrders_self m (by omega))
    · -- m &gt; N: need companion matrices
      push_neg at hle
      -- Case split on m
      rcases Nat.lt_trichotomy m 5 with hm_lt5 | rfl | hm_gt5
      · -- m ∈ {3, 4}: use small case helper
        have hm34 : m ∈ ({3, 4, 6} : Finset ℕ) := by
          simp only [Finset.mem_insert, Finset.mem_singleton]
          omega
        exact mem_integerMatrixOrders_small m N hm34 hpsi
      · -- m = 5
        exact mem_integerMatrixOrders_five N hpsi
      · -- m &gt; 5
        rcases Nat.lt_trichotomy m 6 with hm_lt6 | rfl | hm_gt6
        · omega -- impossible: 5 &lt; m &lt; 6
        · -- m = 6
          exact mem_integerMatrixOrders_small 6 N (by simp) hpsi
        · -- m &gt; 6: general case
          exact mem_integerMatrixOrders_of_psi_le_large m N hm_gt6 hpsi</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/CrystallographicRestriction/Backward.lean#L450-L450" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>

<div class="theorem_thmwrapper sbs-container theorem-style-definition" id="thm:main-theorem">
  <div class="sbs-latex-column">
    <div class="theorem_thmheading">
      <span class="theorem_thmcaption">
      Theorem
      </span>
      <span class="theorem_thmlabel">5.0.19</span>
      <div class="thm_header_extras">

    
    ✓
          </div>
      <div class="thm_header_hidden_extras">

    <a class="icon proof" href="sect0005.html#thm:main-theorem">#</a>
    
    <a class="icon proof" href="sect0005.html#a0000000062"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="sect0002.html#psi-def">Definition 2.0.2</a></li>
          
          <li><a href="sect0003.html#integerMatrixOrders-def">Definition 3.0.1</a></li>
          
          <li><a href="sect0005.html#thm:backward-direction">Theorem 5.0.18</a></li>
          
          <li><a href="sect0005.html#thm:forward-direction">Theorem 5.0.7</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://e-vergo.github.io/General_Crystallographic_Restriction/docs/find/#doc/Crystallographic.crystallographic_restriction" class="lean_decl">Crystallographic.crystallographic_restriction</a></li>
          
        </ul>
    
      </div>
    </div>

    
          </div>
    </div>
    <div class="theorem_thmcontent">
    <p>      <b class="bfseries">The Crystallographic Restriction Theorem:</b> An \(N \times N\) integer matrix can have finite order \(m\) if and only if \(\psi (m) \leq N\). </p>
<p>Equivalently: \(m \in \mathrm{Ord}_N \iff \psi (m) \leq N\). </p>
<p>This theorem completely characterizes which rotation orders are achievable by integer matrices in each dimension. The function \(\psi \) is defined as: \(\psi (1) = \psi (2) = 0\), and for other \(m\), \(\psi (m) = \sum _{p^k \|  m, p \neq 2 \text{ or } k \geq 2} \varphi (p^k)\). </p>
<p><b class="bfseries">Forward direction:</b> If \(A \in \mathbb {Z}^{N \times N}\) has order \(m\), the minimal polynomial of \(A\) over \(\mathbb {Q}\) divides \(X^m - 1\) and must include cyclotomic factors \(\Phi _d\) for divisors \(d\) whose lcm equals \(m\). The sum of \(\varphi (d)\) over these divisors is at least \(\psi (m)\), and this sum bounds the degree of the minimal polynomial, which is at most \(N\). </p>
<p><b class="bfseries">Backward direction:</b> For each prime power \(p^k\) (with \(p \neq 2\) or \(k \geq 2\)), the companion matrix of \(\Phi _{p^k}\) has size \(\varphi (p^k)\) and order \(p^k\). For general \(m\), block diagonal combinations of these companion matrices achieve order \(m\) in dimension \(\psi (m)\). - </p>

    </div>
    <div class="proof_wrapper proof_inline" id="a0000000062">
      <div class="proof_heading">
        <span class="proof_caption">
        Proof
        </span>
        <span class="expand-proof">▶</span>
      </div>
      <div class="proof_content">
      <p> The proof combines the forward and backward directions. The forward direction shows that eigenvalue constraints force \(\psi (m) \leq N\). The backward direction constructs explicit matrices achieving each order using companion matrices of cyclotomic polynomials. - </p>

      </div>
    </div>
  </div>
  <div class="sbs-lean-column">
    <pre class="lean-code"><code class="lean-signature"><span class="lean-plain">theorem crystallographic_restriction (N m : ℕ) (hm : 0 &lt; m) (hNm : m = 1 ∨ 0 &lt; N) :</span></code><code class="lean-proof-body"><span class="lean-plain">(N m : ℕ) (hm : 0 &lt; m) (hNm : m = 1 ∨ 0 &lt; N) :
    m ∈ integerMatrixOrders N ↔ psi m ≤ N :=
  ⟨psi_le_of_mem_integerMatrixOrders N m hm,
   fun hpsi =&gt; mem_integerMatrixOrders_of_psi_le N m hm hpsi hNm⟩</span></code></pre>
    <a href="https://github.com/e-vergo/General_Crystallographic_Restriction/blob/main/Crystallographic/Main/MainTheorem.lean#L72-L72" class="lean-github-hover" target="_blank" title="View on GitHub"><svg  class="icon icon-github "><use xlink:href="symbol-defs.svg#icon-github"></use></svg>
</a>
  </div>
</div>



</div> <!--main-text -->
</div> <!-- content-wrapper -->
</div> <!-- content -->
</div> <!-- wrapper -->

<nav class="prev_up_next">
  <svg  id="showmore-minus" class="icon icon-eye-minus showmore"><use xlink:href="symbol-defs.svg#icon-eye-minus"></use></svg>

  <svg  id="showmore-plus" class="icon icon-eye-plus showmore"><use xlink:href="symbol-defs.svg#icon-eye-plus"></use></svg>

  <a href="sect0004.html" title="Companion Matrices"><svg  class="icon icon-arrow-left "><use xlink:href="symbol-defs.svg#icon-arrow-left"></use></svg>
</a>
  <a href="index.html" title="Crystallographic Restriction Theorem"><svg  class="icon icon-arrow-up "><use xlink:href="symbol-defs.svg#icon-arrow-up"></use></svg>
</a>
  <a href="sect0006.html" title="Appendix"><svg  class="icon icon-arrow-right "><use xlink:href="symbol-defs.svg#icon-arrow-right"></use></svg>
</a>
</nav>

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/plastex.js"></script>
<script type="text/javascript" src="js/svgxuse.js"></script>
<script type="text/javascript" src="js/js.cookie.min.js"></script>
<script type="text/javascript" src="js/showmore.js"></script>
</body>
</html>